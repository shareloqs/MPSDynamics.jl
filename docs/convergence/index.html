<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Convergence checks · MPSDynamics.jl</title><meta name="title" content="Convergence checks · MPSDynamics.jl"/><meta property="og:title" content="Convergence checks · MPSDynamics.jl"/><meta property="twitter:title" content="Convergence checks · MPSDynamics.jl"/><meta name="description" content="Documentation for MPSDynamics.jl."/><meta property="og:description" content="Documentation for MPSDynamics.jl."/><meta property="twitter:description" content="Documentation for MPSDynamics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="MPSDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">MPSDynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../user-guide/">User Guide</a></li><li><a class="tocitem" href="../nutshell/">In a nutshell: MPSDynamics.jl for open quantum systems</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/sbm/">The Spin-Boson Model</a></li><li><a class="tocitem" href="../examples/puredephasing/">Pure-Dephasing</a></li><li><a class="tocitem" href="../examples/timedep/">Time-dependent Hamiltonian</a></li><li><a class="tocitem" href="../examples/anderson-model/">The Anderson Impurity Model</a></li><li><a class="tocitem" href="../examples/bath-observables/">Inspecting the bath by undoing the chain mapping</a></li><li><a class="tocitem" href="../examples/protontransfer/">Proton Transfer Model</a></li><li><a class="tocitem" href="../examples/tailored_sd/">Tailoring the Spectral Density</a></li></ul></li><li class="is-active"><a class="tocitem" href>Convergence checks</a><ul class="internal"><li><a class="tocitem" href="#Approximations"><span>Approximations</span></a></li><li><a class="tocitem" href="#Common-pitfalls"><span>Common pitfalls</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../theory/">Theoretical Background</a></li><li><a class="tocitem" href="../methods/">Methods</a></li><li><a class="tocitem" href="../dev/">Developers</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Convergence checks</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Convergence checks</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Convergence-checks"><a class="docs-heading-anchor" href="#Convergence-checks">Convergence checks</a><a id="Convergence-checks-1"></a><a class="docs-heading-anchor-permalink" href="#Convergence-checks" title="Permalink"></a></h1><p>In this section, we analyze the numerical accuracy of our simulations by outlining the necessary approximations and providing practical guidelines to ensure convergence of results.</p><h2 id="Approximations"><a class="docs-heading-anchor" href="#Approximations">Approximations</a><a id="Approximations-1"></a><a class="docs-heading-anchor-permalink" href="#Approximations" title="Permalink"></a></h2><h3 id="Chain-length-N"><a class="docs-heading-anchor" href="#Chain-length-N">Chain length <span>$N$</span></a><a id="Chain-length-N-1"></a><a class="docs-heading-anchor-permalink" href="#Chain-length-N" title="Permalink"></a></h3><p>In numerical simulations, a truncation on the number of chain modes (and therefore the chain length) is introduced to handle a finite chain instead of a semi-infinite one. This truncation, denoted as <span>$N$</span>, corresponds to a sampling of the modes in the original environment.</p><p>The chain length <span>$N$</span> is directly connected to the simulation time as follows: excitations injected into the chain propagate as a wavefront traveling along the chain. Perturbations to the initial state outside this wavefront are exponentially suppressed. Therefore, truncating the chain basis beyond the expanding wavefront ensures that the resulting sampling error is also exponentially small  <sup class="footnote-reference"><a id="citeref-woods_simulating_2015" href="#footnote-woods_simulating_2015">[woods_simulating_2015]</a></sup><sup class="footnote-reference"><a id="citeref-DeVega_howto_2015" href="#footnote-DeVega_howto_2015">[DeVega_howto_2015]</a></sup>.</p><p>To optimize the chain length for a given simulation time and set of chain coefficients, the following procedure can be used:</p><p>1 Set the total simulation time <code>T</code> and compute the chain coefficients for an intentionally oversized chain <code>N_huge</code> (longer than needed):</p><pre><code class="nohighlight hljs">T = 100 
N_huge = 1000
cpars = chaincoeffs_flat(N_huge, αchain; ωc = 1.0)</code></pre><p>2 Use the built-in function <a href="../methods/#MPSDynamics.findchainlength"><code>findchainlength</code></a> to determine the optimal chain length <code>N_opt</code> based on the propagation speed of the wavefront (given by the hopping coefficients <span>$t_n$</span>):</p><pre><code class="nohighlight hljs">N_opt = findchainlength(T, cpars; eps=10^-4, verbose=false)</code></pre><p>2bis A rule-of-thumb estimate <code>N_est</code> can also be obtained with <a href="../methods/#MPSDynamics.findchainlength"><code>findchainlength</code></a> using universal asymptotic properties of chain mapped environment:</p><pre><code class="nohighlight hljs">N_est = findchainlength(T, ωc, β)</code></pre><h3 id="Local-dimension-d"><a class="docs-heading-anchor" href="#Local-dimension-d">Local dimension <span>$d$</span></a><a id="Local-dimension-d-1"></a><a class="docs-heading-anchor-permalink" href="#Local-dimension-d" title="Permalink"></a></h3><p>Another critical truncation is imposed on the local dimension <span>$d$</span> of each tensor in the MPS that undergoes dynamic evolution. The local dimension <span>$d$</span> corresponds to the number of Fock states retained in the Hilbert space of each chain mode. Since harmonic oscillators are, in principle, infinite-dimensional systems, truncating their Hilbert space to a finite <span>$d$</span> is necessary for numerical computations. The choice of <span>$d$</span> determines the maximum number of excitations per site in the MPS and must be carefully tuned to capture the relevant physics while ensuring numerical convergence. For a bath that initially contains only a finite number of particles, i.e. any bath in practice, the error originating from the local Hilbert space truncation vanishes exponentially as <span>$d$</span> increases<sup class="footnote-reference"><a id="citeref-woods_simulating_2015" href="#footnote-woods_simulating_2015">[woods_simulating_2015]</a></sup>. </p><p>A practical guideline for choosing <span>$d$</span> can be derived by considering the physical states being simulated. For example, for coherent states, the occupation number follows a Poisson distribution. In such cases, the average occupation number is given by the mean <span>$\langle n \rangle$</span>, and the probability of observing a state with occupation number <span>$n$</span> decreases exponentially for <span>$n \gg \langle n \rangle$</span>. Thus, the truncation <span>$d$</span> should be chosen such that the cumulative probability of truncation error is negligible.</p><h3 id="Bond-dimensions-and-time-evolution"><a class="docs-heading-anchor" href="#Bond-dimensions-and-time-evolution">Bond dimensions and time evolution</a><a id="Bond-dimensions-and-time-evolution-1"></a><a class="docs-heading-anchor-permalink" href="#Bond-dimensions-and-time-evolution" title="Permalink"></a></h3><p>Different time-evolution algorithms are implemented in MPSDynamics, and can be selected as options in the function <a href="../methods/#MPSDynamics.runsim-NTuple{4, Any}"><code>runsim</code></a>. Detailed descriptions of these algorithms are provided in the <a href="../theory/#Theoretical-Background">Theoretical Background</a> section of this documentation. The key parameter for ensuring convergence in these methods is controlled via the <code>convparams</code> option, which accepts arrays of multiple parameter values to test until convergence is achieved.</p><p>Below are the main time-evolution algorithms and their corresponding convergence parameters:</p><ul><li>One-Site Time-Dependent Variational Principle (1TDVP):<ul><li>Selected using: <code>method = :TDVP1</code>.</li><li>The convergence parameter is the bond dimension of the MPS, which defines the manifold on which the time evolution is constrained. To ensure convergence, multiple bond dimensions can be tested: <code>convparams = [bond1, bond2, bond3]</code>.</li></ul></li><li>Two-Site Time-Dependent Variational Principle (2TDVP):<ul><li>Selected using: <code>method = :TDVP2</code>.</li><li>The convergence parameter is the SVD singular value truncation threshold, which determines the precision of the truncation during simulations. Multiple truncation thresholds can be tested: <code>convparams = [trunc1, trunc2, trunc3]</code>.</li><li>The bond dimensions at each chain-site and at each time-step can be saved by specifying <code>savebonddims = true</code>. The maximum allowed value of bond dimension can be chosen by setting the <code>Dlim</code> option.</li></ul></li><li>Adaptive Time-Dependent Variational Principle (DTDVP):<ul><li>Selected using: <code>method = :DTDVP</code>.</li><li>The convergence parameter is the target precision for the adaptive algorithm. Multiple precision values can be provided to test convergence: <code>convparams = [prec1, prec2, prec3]</code>.</li><li>The bond dimensions at each chain-site and at each time-step can be saved by specifying <code>savebonddims = true</code>. The maximum allowed value of bond dimension can be chosen with the <code>Dlim</code> option.</li><li>In some cases, it might be better to embed the initial time MPS in a manifold of higher bond-dimension, which can be done with the function <code>mpsembed!</code>, to avoid for the dynamics to get stuck.</li></ul></li></ul><h3 id="Time-step"><a class="docs-heading-anchor" href="#Time-step">Time-step</a><a id="Time-step-1"></a><a class="docs-heading-anchor-permalink" href="#Time-step" title="Permalink"></a></h3><p>The time step used in simulations must be small enough to accurately capture the dynamics of the system. To ensure convergence, gradually reduce the time step until key observables (e.g., energy, population dynamics, or correlation functions) stabilize. It is often practical to test a range of time steps and assess their impact on results to determine an optimal balance between accuracy and computational cost.</p><h2 id="Common-pitfalls"><a class="docs-heading-anchor" href="#Common-pitfalls">Common pitfalls</a><a id="Common-pitfalls-1"></a><a class="docs-heading-anchor-permalink" href="#Common-pitfalls" title="Permalink"></a></h2><h3 id="Hard-cut-off-in-the-spectral-density-function"><a class="docs-heading-anchor" href="#Hard-cut-off-in-the-spectral-density-function">Hard cut-off in the spectral density function</a><a id="Hard-cut-off-in-the-spectral-density-function-1"></a><a class="docs-heading-anchor-permalink" href="#Hard-cut-off-in-the-spectral-density-function" title="Permalink"></a></h3><p>The cutoff frequency <span>$\omega_c$</span> in the spectral density function has to be selected in order to incorporate all of the relevant frequencies. It is to be noted that, for spectral densities belonging to the Szegö class<sup class="footnote-reference"><a id="citeref-chin_exact_2010" href="#footnote-chin_exact_2010">[chin_exact_2010]</a></sup>, the cutoff frenquency <span>$\omega_c$</span> also determines the asymptotic values to which the chain coefficients converge <sup class="footnote-reference"><a id="citeref-woods_mappings_2014" href="#footnote-woods_mappings_2014">[woods_mappings_2014]</a></sup>. Therefore, if we want to reach translational invariance (converged values) in the chain coefficients, then we need to specify a cutoff. To avoid boundary effects, it is a good choice to select cutoff frequency such that the frequency range covers well the different frequencies of the system.</p><h3 id="Memory-limit-for-cluster-users"><a class="docs-heading-anchor" href="#Memory-limit-for-cluster-users">Memory limit for cluster users</a><a id="Memory-limit-for-cluster-users-1"></a><a class="docs-heading-anchor-permalink" href="#Memory-limit-for-cluster-users" title="Permalink"></a></h3><p>When using MPSDynamics in clusters, the julia option &quot;heap-size-hint&quot;  has to be added when starting julia to keep the available memory limited. Otherwise, julia takes too much memory in the node and simulation crashes. A typical command line would be :</p><pre><code class="nohighlight hljs">julia --heap-size-hint=1G $Path_script/script.jl </code></pre><p>When launching a job, for instance with <code>sbatch</code>, it can be useful to specify <code>--hint=nomultithread</code>, as multithreading is not currently supported by MPSDynamics.</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-woods_simulating_2015"><a class="tag is-link" href="#citeref-woods_simulating_2015">woods_simulating_2015</a>Woods, M. P.; Cramer, M.; Plenio, M. B. Simulating Bosonic Baths with Error Bars. Phys. Rev. Lett. 2015, 115 (13), 130401. https://doi.org/10.1103/PhysRevLett.115.130401.</li><li class="footnote" id="footnote-DeVega_howto_2015"><a class="tag is-link" href="#citeref-DeVega_howto_2015">DeVega_howto_2015</a>De Vega, I.; Schollwöck, U.; Wolf, F. A. How to Discretize a Quantum Bath for Real-Time Evolution. Phys. Rev. B 2015, 92 (15), 155126. https://doi.org/10.1103/PhysRevB.92.155126.</li><li class="footnote" id="footnote-woods_mappings_2014"><a class="tag is-link" href="#citeref-woods_mappings_2014">woods_mappings_2014</a>Woods,  M. P. et al. “Mappings of open quantum systems onto chain representations and Markovian embeddings”. In: Journal of Mathematical Physics 55.3 (Mar. 2014), p. 032101. issn: 0022-2488, 1089-7658. doi: 10.1063/1.4866769</li><li class="footnote" id="footnote-chin_exact_2010"><a class="tag is-link" href="#citeref-chin_exact_2010">chin_exact_2010</a>Chin, A. W.  et al. “Exact mapping between system-reservoir quantum models and semi-infinite discrete chains using orthogonal polynomials”. In: Journal of Mathematical Physics 51.9 (Sept. 2010), p. 092109. issn: 0022-2488, 1089-7658. doi: 10.1063/1.3490188. arXiv: 1006.4507</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/tailored_sd/">« Tailoring the Spectral Density</a><a class="docs-footer-nextpage" href="../theory/">Theoretical Background »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.9.0 on <span class="colophon-date" title="Thursday 18 September 2025 10:06">Thursday 18 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
