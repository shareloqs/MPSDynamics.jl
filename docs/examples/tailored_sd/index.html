<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tailoring the Spectral Density · MPSDynamics.jl</title><meta name="title" content="Tailoring the Spectral Density · MPSDynamics.jl"/><meta property="og:title" content="Tailoring the Spectral Density · MPSDynamics.jl"/><meta property="twitter:title" content="Tailoring the Spectral Density · MPSDynamics.jl"/><meta name="description" content="Documentation for MPSDynamics.jl."/><meta property="og:description" content="Documentation for MPSDynamics.jl."/><meta property="twitter:description" content="Documentation for MPSDynamics.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="MPSDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MPSDynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../user-guide/">User Guide</a></li><li><a class="tocitem" href="../../nutshell/">In a nutshell: MPSDynamics.jl for open quantum systems</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../sbm/">The Spin-Boson Model</a></li><li><a class="tocitem" href="../puredephasing/">Pure-Dephasing</a></li><li><a class="tocitem" href="../timedep/">Time-dependent Hamiltonian</a></li><li><a class="tocitem" href="../anderson-model/">The Anderson Impurity Model</a></li><li><a class="tocitem" href="../bath-observables/">Inspecting the bath by undoing the chain mapping</a></li><li><a class="tocitem" href="../protontransfer/">Proton Transfer Model</a></li><li class="is-active"><a class="tocitem" href>Tailoring the Spectral Density</a><ul class="internal"><li><a class="tocitem" href="#Context"><span>Context</span></a></li><li><a class="tocitem" href="#The-code-to-define-a-specific-spectral-density"><span>The code to define a specific spectral density</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../convergence/">Convergence checks</a></li><li><a class="tocitem" href="../../theory/">Theoretical Background</a></li><li><a class="tocitem" href="../../methods/">Methods</a></li><li><a class="tocitem" href="../../dev/">Developers</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Tailoring the Spectral Density</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tailoring the Spectral Density</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tailoring-the-Spectral-Density"><a class="docs-heading-anchor" href="#Tailoring-the-Spectral-Density">Tailoring the Spectral Density</a><a id="Tailoring-the-Spectral-Density-1"></a><a class="docs-heading-anchor-permalink" href="#Tailoring-the-Spectral-Density" title="Permalink"></a></h1><h2 id="Context"><a class="docs-heading-anchor" href="#Context">Context</a><a id="Context-1"></a><a class="docs-heading-anchor-permalink" href="#Context" title="Permalink"></a></h2><p>Here we detail an example to tailor the Spectral Density (SD) used to represent the bath. While the initial chain mapping procedure has been automatized for thermalized Ohmic type of SD (thanks to the methods <a href="../../methods/#MPSDynamics.chaincoeffs_ohmic-Tuple{Any, Any, Any}"><code>MPSDynamics.chaincoeffs_ohmic</code></a> and <a href="../../methods/#MPSDynamics.chaincoeffs_finiteT"><code>MPSDynamics.chaincoeffs_finiteT</code></a>), it is possible to describe other types of SD. In this example, the SD is treated either with a continuous definition for several frequency domains or with a discrete description with frequency values and corresponding spectral density values as inputs. </p><p>The Spin-Boson Model is chosen to illustrate this example. For details about the model, we refer the interested reader to the example <a href="../sbm/#The-Spin-Boson-Model">The Spin-Boson Model</a>.</p><h2 id="The-code-to-define-a-specific-spectral-density"><a class="docs-heading-anchor" href="#The-code-to-define-a-specific-spectral-density">The code to define a specific spectral density</a><a id="The-code-to-define-a-specific-spectral-density-1"></a><a class="docs-heading-anchor-permalink" href="#The-code-to-define-a-specific-spectral-density" title="Permalink"></a></h2><p>We describe here only differences with the Spin-Boson Model in order to parametrize the Hamiltonian with a specific spectral density.</p><p>First, we load the <code>MPSdynamics.jl</code> package to be able to perform the simulation, the <code>Plots.jl</code> one to plot the results, the <code>LaTeXStrings.jl</code> one to be able to use <span>$\LaTeX$</span> in the plots. A notation is introduced for <code>+∞</code>.</p><pre><code class="language-julia hljs">using MPSDynamics, Plots, LaTeXStrings

const ∞  = Inf</code></pre><p>We then define variables for the physical parameters of the simulation.</p><pre><code class="language-julia hljs">#----------------------------
# Physical parameters
#----------------------------

ω0 = 0.2 # TLS gap

Δ = 0.0 # tunneling </code></pre><p>Now comes the definition of the spectral density. The type of SD has to be chosen between <code>:Discrete</code> and <code>:Continuous</code> (one choice has to be commented instead of the other). </p><p>For the <code>:Discrete</code> definition, the bath inputs become the discrete frequencies (<code>freqs</code>) with the corresponding spectral density values (<code>Jω</code>). </p><p>For the <code>:Continuous</code> definition, the bath inputs are as usual. Among these, two are convergence parameters:</p><ul><li><code>d</code> is the number of states we retain for the truncated harmonic oscillators representation of environmental modes</li><li><code>N</code> is the number of chain (environmental) modes we keep. This parameters determines the maximum simulation time of the simulation: indeed excitations that arrive at the end of the chain are reflected towards the system and can lead to unphysical results</li></ul><p>The value of <code>β</code> determines whether the environment is thermalized or not. The example as it is is the zero-temperature case. For the finite-temperature case, &#39;β = ∞&#39; has be commented instead of the line above that precises a <code>β</code> value.</p><p>After the parameters, the SD formulation has still to be defined according to the parameters. For that purpose, frequency domains have to be defined with the <code>AB</code> list and a function has to describe the spectral density formula for each domain. In order to follow the T-TEDOPA formulation, formula have to be modified as illustrated when the environment is thermalized. The presented example reproduces an Ohmic SD but frequency domains and formula can be changed at will. </p><pre><code class="language-julia hljs">#-----------------------
# Options and parameters for the Spectral Density
# Definition of the frequency ranges and J(ω) formula for the continuous case
#-----------------------

#Jω_type=:Discrete

Jω_type=:Continuous

if Jω_type==:Discrete
    
    freqs = [0.05, 0.10, 0.15, 0.20, 0.25, 0.30, 0.35, 0.40, 0.45, 0.50] # Frequency value
    
    Jω = [0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.10] # Value of the spectral density at the respective frequency
    
    N = length(freqs) # The number of mode in the chain is set with the number of discrete frequencies
    
    d = 6 # number of Fock states of the chain modes

elseif Jω_type==:Continuous 

    N = 30 # length of the chain

    d = 6 # number of Fock states of the chain modes

    α = 0.1 # coupling strength
    
    s = 1 # ohmicity
    
    ωc = 1.0 # Cut-off of the spectral density J(ω) 
    
    #β = 100 # Thermalized environment
    β = ∞ # Case zero temperature T=0, β → ∞

    # AB segments correspond to the different frequency ranges where the spectral density is defined.
    # It corresponds to i=1 ; i=2 ; i=3 and i=4 of the Jω_fct(ω,i) function.

    # The y formula and the frequency ranges can be changed while keeping the extra terms for thermalized environments.
    # This example reproduces an Ohmic type spectral density. 

    AB = [[-Inf -ωc];[-ωc 0];[0 ωc];[ωc Inf]]

    function Jω_fct(ω,i)
        if i==1 # First segment of AB (here [-Inf -ωc])
            y = 0
        elseif i==2 # Second segment of AB (here [-ωc 0])
            if β == ∞
                y = 0 # zero for negative frequencies when β == Inf   
            else
		y = -2*α*abs.(ω).^s / ωc^(s-1) .* (coth.((β/2).*ω) .+ 1) ./2 # .* (coth.((β/2).*ω) .+ 1) ./2 and the abs.(ω) have to be added when β != Inf (T-TEDOPA formulation) 
            end
        elseif i==3 # Third segment of AB (here [0 ωc])
            if β == ∞
                y = 2*α*ω.^s / ωc^(s-1) 
            else
		y = 2*α*ω.^s / ωc^(s-1) .* (coth.((β/2).*ω) .+ 1) ./2  # .* (coth.((β/2).*ω) .+ 1) ./2 has to be added when β != Inf (T-TEDOPA formulation) 
            end       
        elseif i==4 # Fourth segment of AB (here [ωc Inf])
            y = 0
        end
        return y
    end
    
else

    throw(ErrorException(&quot;The spectral density has either to be Continuous or Discrete&quot;))

end</code></pre><p>Now that the type of SD and the corresponding parameters have been filled in, the chain parameters have to be calculated. </p><p>For both cases, the method <a href="../../methods/#MPSDynamics.chaincoeffs_finiteT"><code>MPSDynamics.chaincoeffs_finiteT</code></a> can be called with the respective inputs.</p><pre><code class="language-julia hljs">#-----------------------
# Calculation of chain parameters
#-----------------------

if Jω_type==:Discrete

    cpars = chaincoeffs_finiteT_discrete(β, freqs, Jω; procedure=:Lanczos, Mmax=5000, save=false)  # chain parameters, i.e. on-site energies ϵ_i, hopping energies t_i, and system-chain coupling c_0

#= If cpars is stored in &quot;../ChainOhmT/discreteT&quot; 
    curdir = @__DIR__
    dir_chaincoeff = abspath(joinpath(curdir, &quot;../ChainOhmT/discreteT&quot;))
    cpars  = readchaincoeffs(&quot;$dir_chaincoeff/chaincoeffs.h5&quot;, N, β) # chain parameters, i.e. on-site energies ϵ_i, hopping energies t_i, and system-chain coupling c_0
=#

elseif Jω_type==:Continuous

    cpars = chaincoeffs_finiteT(N, β, false; α=α, s=s, J=Jω_fct, ωc=ωc, mc=size(AB)[1], mp=0, AB=AB, iq=1, idelta=2, procedure=:Lanczos, Mmax=5000, save=false)  # chain parameters, i.e. on-site energies ϵ_i, hopping energies t_i, and system-chain coupling c_0

end</code></pre><p>Next, similarly to the spin-boson example, the simulation parameters are set with the initial MPO and MPS in order to carry out the dynamics propagation. Therefore, this modified example shows an easy way to tailor the spectral density for any system and Hamiltonian.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../protontransfer/">« Proton Transfer Model</a><a class="docs-footer-nextpage" href="../../convergence/">Convergence checks »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.9.0 on <span class="colophon-date" title="Wednesday 2 July 2025 08:05">Wednesday 2 July 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
